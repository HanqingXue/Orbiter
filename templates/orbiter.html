<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>卫星模拟系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{{ static_url('css/bootstrap.min.css') }}" rel="stylesheet">
    <link href="{{ static_url('css/flat-ui.min.css') }}"   rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="{{ static_url('css/index.css') }}">
    <script src="{{ static_url('js/jquery.min.js') }}"></script>
    <script src="{{ static_url('js/flat-ui.min.js') }}"></script>
    <script src="{{ static_url('js/three.js') }}"></script>
    <script src="{{ static_url('js/Projector.js') }}"></script>
    <script src="{{ static_url('js/CanvasRenderer.js') }}"></script>
    <script src="{{ static_url('js/stats.min.js') }}"></script>
    <script type="text/javascript" src="{{ static_url('js/echarts.min.js') }}"></script>
    <script type="text/javascript" src="{{ static_url('js/echarts-gl.min.js') }}"></script>
    <style type="text/css">
      .missile 
      {
        margin-bottom: 5px;
      }
    </style>
  </head>
  <body onload='onLoad();'>
    <div id="navigation">
      <nav class="navbar navbar-inverse" role="navigation">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse-01">
            <span class="sr-only">Toggle navigation</span>
          </button>
          <a class="navbar-brand" href="#" style="">卫星模拟系统</a>
        </div>
        <div class="collapse navbar-collapse" id="navbar-collapse-01">
          <form class="navbar-form navbar-right" action="#" role="search">
            <div class="form-group">
              <div class="input-group">
                <input class="form-control" id="navbarInput-01" type="search" placeholder="Search">
                <span class="input-group-btn">
                  <button type="submit" class="btn"><span class="fui-search"></span></button>
                </span>
              </div>
            </div>
          </form>
        </div>
      </nav>
    </div>
    <div class="container">
    	      <div class="col-md-4">
        <div id="overview" class="section">
            <div class="header">
                <h5><i class="fa fa-desktop"></i> 参数</h5>
                <a href="javascript:void(0)">
                    <i class="fa fa-caret-down"></i>
                </a>
            </div> <!-- .header -->
            <div class="body">
              <div class="row-fluid">
                <p><b>同步卫星参数</b></p>
              </div>
              <div class="row-fluid" >
                    <div class="col-md-6">同步卫星方位角</div>
                    <div class="col-md-6">
                      <input class="form-control">
                    </div> <!-- .span8 -->
              </div> <!-- .row-fluid -->
              <div class="row-fluid">
                <p><b>导弹参数</b></p>
              </div>
              <div class="row-fluid" >
                    <div class="col-md-6">初速度</div>
                    <div class="col-md-6 missile">
                      <input class="form-control">
                    </div> <!-- .span8 -->
              </div> <!-- .row-fluid -->
              <div class="row-fluid" >
                    <div class="col-md-6">仰角</div>
                    <div class="col-md-6 missile">
                      <input class="form-control">
                    </div> <!-- .span8 -->
              </div> <!-- .row-fluid -->
              <div class="row-fluid">
                  <div class="col-md-6">方位角</div>
                  <div class="col-md-6 missile">
                    <input class="form-control">
                  </div>
              </div>
              <div class="row-fluid">
                  <div class="col-md-6">纬度</div>
                  <div class="col-md-6 missile">
                    <input class="form-control">
                  </div>
              </div>
              <div class="row-fluid">
                  <div class="col-md-6">经度</div>
                  <div class="col-md-6 missile">
                    <input class="form-control">
                  </div>
              </div>
              <div class="row-fluid">
                  <div class="col-md-6">虚警概率</div>
                  <div class="col-md-6 missile">
                    <input class="form-control">
                  </div>
              </div>
              <div class="row-fluid">
                  <div class="col-md-6">尾焰燃烧强度</div>
                  <div class="col-md-6 missile">
                    <input class="form-control">
                  </div>
              </div>
            </div> <!-- .body -->
            <button class="btn btn-embossed btn-primary col-md-12 missile" id="submit" onclick="sendMsg()">
          提交
            </button>
        </div> <!-- .section -->

        <div class="section">
          <div class="header">
            <h5><i class="fa fa-desktop"></i> 实时数据</h5>
              <a href="javascript:void(0)">
                <i class="fa fa-caret-down"></i>
              </a>
          </div>
          <div class="body">
          	<div class="row-fluid">
              <div class="col-md-6">探测概率</div>
              <div class="col-md-6"><p id="prob">0%</p></div> 
            </div>
          </div>
        </div>
        <button class="btn btn-embossed btn-primary col-md-12 missile" id="orbit">
          3D轨迹绘制
        </button>
      </div><!--/.col-md-->

    <!-- /.container -->
      <div class="col-md-8">
        <div class="alert alert-warning " style="display: none">
          <a href="#" class="close" data-dismiss="alert">
            &times;
          </a>
          <strong>警告！</strong>您的输入数据有问题。
        </div>
        <div class="section">
          <div class="header">
            <h5><i class="fa fa-desktop"></i>轨迹追踪</h5>
                <a href="javascript:void(0)">
                    <i class="fa fa-caret-down"></i>
                </a>
          </div>
          <div class="body" >
      		  <div id="container" style="width: 700px;height: 700px"></div>
      	  </div>
        </div>
</body>
<script type="text/javascript">
var chart = echarts.init(document.getElementById('container'));
var prob = echarts.init(document.getElementById('prob'));
/*
 点的格式是[经度， 维度]
*/
var routes = [
  [[39.956589, 43.449928],[115.00, 39.0011, ]]]
chart.setOption({
    backgroundColor: '#FFF',
    globe: {
        baseTexture: "{{ static_url('images/earth.jpeg')}}",
        //heightTexture: '/asset/get/s/data-1491889019097-rJQYikcpl.jpg',
        shading: 'lambert',
        light: {
            ambient: {
                intensity: 0.3
            },
            main: {
                intensity: 0.3
            }
        },
        viewControl: {
            autoRotate: false,
            targetCoord: [116.46, 39.92]
        }
    },
    series: {
        type: 'lines3D',
        coordinateSystem: 'globe',
        blendMode: 'lighter',
        lineStyle: {
            width: 2,
            color: '#3A5FCD',
            opacity: 0.9
        },

        effect: {
                show: true,
                period: 4,
                trailLength: 0.02,
                symbol: 'arrow',
                symbolSize: 5,
        },
        data: routes
    }
});
</script>
<script type="text/javascript">
var option = {
    title : {
        text: '未来一周气温变化',
        subtext: '纯属虚构'
    },
    tooltip : {
        trigger: 'axis'
    },
    legend: {
        data:['最高气温','最低气温']
    },
    toolbox: {
        show : true,
        feature : {
            mark : {show: true},
            dataView : {show: true, readOnly: false},
            magicType : {show: true, type: ['line', 'bar']},
            restore : {show: true},
            saveAsImage : {show: true}
        }
    },
    calculable : true,
    xAxis : [
        {
            type : 'category',
            boundaryGap : false,
            data : ['周一','周二','周三','周四','周五','周六','周日']
        }
    ],
    yAxis : [
        {
            type : 'value',
            axisLabel : {
                formatter: '{value} °C'
            }
        }
    ],
    series : [
        {
            name:'最高气温',
            type:'line',
            data:[11, 11, 15, 13, 12, 13, 10],
            markPoint : {
                data : [
                    {type : 'max', name: '最大值'},
                    {type : 'min', name: '最小值'}
                ]
            },
            markLine : {
                data : [
                    {type : 'average', name: '平均值'}
                ]
            }
        },
        {
            name:'最低气温',
            type:'line',
            data:[1, -2, 2, 5, 3, 2, 0],
            markPoint : {
                data : [
                    {name : '周最低', value : -2, xAxis: 1, yAxis: -1.5}
                ]
            },
            markLine : {
                data : [
                    {type : 'average', name : '平均值'}
                ]
            }
        }
    ]
};
prob.setOption(option);
</script>
<script type="text/javascript">  
    var ws;  
    function onLoad(){  
        ws = new WebSocket("ws://localhost:8000/ws");  
        ws.onmessage = function(e){  
            //alert(e.data)
            console.log(e.data);
            var data = JSON.parse(e.data);
            if( typeof(data['prob']) == 'undefined') {
              console.log("hello");
            } else {
              $('#prob').text(data['prob'] + '%');
            }
        }  
    }  
    function sendMsg(){  
        ws.send("hehe");  
    }  
</script> 
</html>
